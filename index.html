<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nathan Johnson — Personal Site</title>
  <meta name="description" content="Simple and sleek single-page portfolio for Nathan Johnson.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Warm Minimal Monochrome palette */
      --bg: #F6F0E7;         /* Cream - background texture */
      --text: #7C6E63;       /* Muted Cocoa - body text */
      --soft: #FBFAF8;       /* Ivory - cards/containers */
      --accent: #3A3330;     /* Dark Espresso - hero & buttons */
      --secondary: #7C6E63;  /* Muted Cocoa - secondary text */
      --shadow: rgba(58, 51, 48, 0.06); /* Dark Espresso shadow */
      
      /* Section and card colors */
      --panel-bg: #f1ede7;        /* Soft Taupe - section backgrounds (matches icons) */
      --card-project: #f5f0ea;    /* Warm cream - project cards */
      --card-timeline: #f5f0ea;   /* Warm cream - timeline cards */
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.6;
      scroll-behavior: smooth;
      position: relative;
    }

    #waveCanvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      width: 100%;
      height: 100%;
    }

    img {
      max-width: 100%;
      display: block;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .page {
      max-width: 1000px;
      margin: 0 auto;
      padding: 2rem clamp(1.5rem, 4vw, 3rem) 4rem;
      position: relative;
      z-index: 1;
    }

    header {
      min-height: 85vh;
      display: flex;
      align-items: center;
    }

    .hero {
      width: 100%;
      padding-top: 4rem;
    }

    .hero-eyebrow {
      display: inline-flex;
      align-items: center;
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      background: rgba(251, 250, 248, 0.85);
      color: var(--accent);
      padding: 0.35rem 0.9rem;
      border-radius: 999px;
      margin-bottom: 1.5rem;
    }

    h1 {
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      font-weight: 300;
      margin: 0 0 1rem;
      line-height: 1.1;
      color: var(--accent);
    }

    h2 {
      font-size: clamp(2rem, 4vw, 3rem);
      margin-bottom: 0.5rem;
      font-weight: 300;
      color: var(--text);
    }

    h3 {
      margin: 0 0 0.6rem;
      font-size: 1.25rem;
      font-weight: 500;
      color: var(--accent);
    }
    
    /* Subheading for expanded project details */
    .project-details h3 {
        font-size: clamp(1.8rem, 4vw, 2.5rem);
        font-weight: 300;
        margin: 0 0 2rem;
        color: var(--accent);
        line-height: 1.1;
    }

    .project-details h4 {
        font-size: 1.1rem;
        font-weight: 600;
        margin: 1.5rem 0 0.5rem;
        color: var(--text);
    }
    
    .project-details p {
        margin-bottom: 0.5rem;
    }

    .hero p {
      max-width: 48ch;
      font-size: 1.15rem;
      margin-bottom: 2.5rem;
      color: var(--text);
      font-weight: 300;
    }

    .hero-socials {
      display: flex;
      flex-wrap: wrap;
      gap: 0.85rem;
      margin-top: 2.5rem;
    }

    .social-link {
      border-radius: 999px;
      padding: 0.85rem 1.5rem;
      font-size: 0.9rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.6rem;
      border: 1px solid rgba(58, 51, 48, 0.15);
      background: #e3dcd5;
      color: var(--accent);
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(58, 51, 48, 0.08);
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

    .social-link svg,
    .social-link .icon {
      width: 1.1rem;
      height: 1.1rem;
      fill: currentColor;
    }

    .social-link:hover,
    .social-link:focus-visible {
      background: #CCC2B5;
      box-shadow: 0 15px 35px rgba(58, 51, 48, 0.12);
      outline: none;
    }

    .social-link.is-email {
      position: relative;
      overflow: visible;
      border-style: solid; /* Keep border style from original but override other props */
    }

    .social-link.is-email .copy-label {
      position: absolute;
      left: calc(100% + 0.5rem);
      top: 50%;
      transform: translateY(-50%) translateX(0.4rem);
      padding: 0.4rem 0.85rem;
      border-radius: 999px;
      border: 1px dashed rgba(58, 51, 48, 0.3);
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 12px 30px rgba(58, 51, 48, 0.1);
      font-size: 0.85rem;
      font-family: inherit;
      font-weight: 500;
      letter-spacing: 0.02em;
      color: var(--text);
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease, transform 0.25s ease;
      /* Resetting properties from previous version */
      max-width: unset;
      margin-left: 0;
    }

    .social-link.is-email.show-feedback {
      background: #CCC2B5;
      box-shadow: 0 15px 35px rgba(58, 51, 48, 0.15);
      /* Resetting padding from previous version */
      padding-right: 1.5rem; 
      border-color: rgba(58, 51, 48, 0.15);
    }

    .social-link.is-email.show-feedback .copy-label {
      opacity: 1;
      transform: translateY(-50%) translateX(0);
      /* Resetting max-width from previous version */
      max-width: unset;
      margin-left: 0;
    }

    section {
      padding: 4rem 0;
    }

    .panel {
      background: var(--panel-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 24px;
      border: 1px solid rgba(58, 51, 48, 0.06);
      box-shadow: 0 8px 30px rgba(58, 51, 48, 0.04);
      padding: clamp(2.5rem, 4vw, 4rem);
      margin-bottom: 3.5rem;
      position: relative;
      overflow: hidden; 
      will-change: height; /* Hint to browser for smoother expansion */
      transition: transform 0.5s ease, height 0.6s cubic-bezier(0.25, 1, 0.5, 1); /* Updated timing for smoothness */
    }
    
    /* .panel:not(.has-expanded-card):hover {
        hover effects removed
    } */
    
    .panel.has-expanded-card {
        transform: none !important;
    }

    .section-heading {
      max-width: 720px;
      margin-bottom: 3rem;
      text-align: center;
      margin-left: auto;
      margin-right: auto;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .section-heading p {
      margin: 0;
      color: var(--text);
      font-weight: 300;
    }

    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.1em;
      font-weight: 600;
      font-size: 0.75rem;
      color: var(--accent);
      margin-bottom: 1rem;
      display: block;
    }

    .project-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      transition: opacity 0.5s ease, transform 0.5s ease;
      position: relative;
    }

    .project-card {
      background: var(--card-project);
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(58, 51, 48, 0.03);
      border: 1px solid rgba(58, 51, 48, 0.05);
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      position: relative;
      z-index: 1;
      transition:
        transform 0.6s cubic-bezier(0.2, 0, 0.2, 1),
        width 0.6s cubic-bezier(0.2, 0, 0.2, 1),
        height 0.6s cubic-bezier(0.2, 0, 0.2, 1),
        top 0.6s cubic-bezier(0.2, 0, 0.2, 1),
        left 0.6s cubic-bezier(0.2, 0, 0.2, 1),
        background-color 0.6s ease,
        box-shadow 0.6s ease,
        border-radius 0.6s ease;
    }

    .project-card:not(.expanded):hover {
      background: var(--card-project);
      box-shadow: 0 10px 15px -3px rgba(58, 51, 48, 0.08);
    }

    /* --- EXPANDED STATE STYLES --- */
    
    /* Hide other cards when one is expanding/expanded */
    .project-grid.has-expanded-card .project-card:not(.expanded) {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .panel.has-expanded-card .section-heading {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .panel.has-expanded-card .project-grid {
      /* Prevent grid collapse from affecting panel momentarily */
      min-height: 1px; 
    }

    /* The expanded card takes over */
    .project-card.expanded {
      /* Position will be handled by JS for animation, then locked here if needed */
      z-index: 10;
      border-radius: 24px; 
      background: var(--card-project);
      margin: 0;
      padding: clamp(2rem, 5vw, 4rem);
      overflow-y: auto; /* Allow scrolling if content is too long */
      cursor: default;
      box-shadow: none;
      border: none;
    }

    .project-summary {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      opacity: 1;
      transition: opacity 0.3s ease;
      flex: 1; /* Makes the summary fill the card height */
    }

    /* Normalize title height so descriptions start at the same vertical position */
    .project-summary h3 {
      min-height: 3rem; /* Reserves space for ~2 lines of text */
      line-height: 1.2;
      display: flex;
      align-items: flex-start; /* Align text to top */
    }
    
    .project-card.fading-out .project-summary {
      opacity: 0;
    }

    .project-meta {
      font-size: 0.75rem;
      letter-spacing: 0.05em;
      color: var(--accent);
      text-transform: uppercase;
      font-weight: 600;
    }

    .project-link {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      cursor: pointer;
    }

    .project-link::after {
      content: '→';
      transition: transform 0.2s ease;
      color: var(--accent);
    }

    .project-card:not(.expanded) .project-link {
      margin-top: auto;
    }

    .project-card:not(.expanded):hover .project-link::after {
      transform: translateX(4px);
    }

    .project-card.is-fading-summary .project-summary {
      opacity: 0;
    }

    .project-card.summary-hidden .project-summary {
      display: none;
    }

    .project-card.expanded .project-summary {
      display: none;
    }

    .project-details {
      display: none;
      opacity: 0;
      margin-top: 0; /* Reset margin as it's the main content now */
      border-top: none;
      padding-top: 0;
      transition: opacity 0.4s ease;
    }

    .project-card.expanded .project-details {
      display: block;
    }

    .project-card.details-visible .project-details {
      opacity: 1;
    }

    /* Project Images Section */
    .project-gallery {
      margin-top: 2rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .project-gallery img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      border: 1px solid rgba(58, 51, 48, 0.08);
      transition: transform 0.3s ease;
    }

    .project-gallery img:hover {
      transform: scale(1.02);
    }
    
    .project-gallery-caption {
        font-size: 0.8rem;
        color: var(--secondary);
        margin-top: 0.5rem;
        text-align: center;
        width: 100%;
    }

    .project-card.expanded .project-link {
      display: none;
    }

    /* Back Button */
    .close-btn {
      display: none;
      margin-bottom: 1.5rem;
      background: transparent;
      border: none;
      color: var(--accent);
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      padding: 0;
      align-items: center;
      gap: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .project-card.expanded .close-btn {
      display: inline-flex;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    /* --- TIMELINE & REST --- */

    .timeline {
      position: relative;
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem 0;
    }

    /* The vertical line */
    .timeline::before {
      content: '';
      position: absolute;
      left: 1.65rem; /* Center of the marker */
      top: 0;
      bottom: 0;
      width: 2px;
      background: rgba(58, 51, 48, 0.08);
      border-radius: 2px;
    }

    .timeline-item {
      position: relative;
      padding-left: 5rem;
      margin-bottom: 3rem;
    }
    
    .timeline-item:last-child {
        margin-bottom: 0;
    }

    .timeline-marker {
      position: absolute;
      left: 1rem;
      top: 2rem; /* Align with the card's top padding roughly */
      width: 1.3rem;
      height: 1.3rem;
      border-radius: 50%;
      background: var(--bg);
      border: 2px solid var(--accent);
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease, background-color 0.3s ease;
      box-shadow: 0 0 0 6px var(--bg); /* Mask the line behind it */
    }
    
    .timeline-marker::after {
        content: '';
        width: 6px;
        height: 6px;
        background: var(--accent);
        border-radius: 50%;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .timeline-item:hover .timeline-marker {
        transform: scale(1.1);
        border-color: var(--accent);
    }
    
    .timeline-item:hover .timeline-marker::after {
        opacity: 1;
    }

    .timeline-content {
      position: relative;
      background: var(--card-timeline);
      border-radius: 20px;
      padding: 2rem;
      border: 1px solid rgba(58, 51, 48, 0.04);
      box-shadow: 0 2px 8px rgba(58, 51, 48, 0.02);
      /* Kinetic Layering: Smoother easing for lift */
      transition: transform 0.4s cubic-bezier(0.2, 0, 0.2, 1), box-shadow 0.4s cubic-bezier(0.2, 0, 0.2, 1);
    }
    
    /* Arrow pointing to timeline marker */
    .timeline-content::before {
      content: '';
      position: absolute;
      left: -6px;
      top: 2.65rem; /* Aligns with the center of the marker */
      width: 12px;
      height: 12px;
      background: var(--card-timeline);
      border-left: 1px solid rgba(58, 51, 48, 0.04);
      border-bottom: 1px solid rgba(58, 51, 48, 0.04);
      transform: translateY(-50%) rotate(45deg);
      border-radius: 0 0 0 2px;
    }

    /* Left-Rail Accent */
    .timeline-content::after {
      content: "";
      position: absolute;
      left: 0;
      top: 20px;
      bottom: 20px;
      width: 3px;
      background: var(--accent);
      opacity: 0.2;
      transition: opacity 0.3s ease;
      border-radius: 0 4px 4px 0;
    }
    
    .timeline-item:hover .timeline-content {
        /* Lift removed, just shadow and accent update */
        box-shadow: 0 20px 40px -5px rgba(58, 51, 48, 0.1);
    }
    
    .timeline-item:hover .timeline-content::after {
      opacity: 1;
    }

    .timeline-header {
        margin-bottom: 1.25rem;
        border-bottom: 1px solid rgba(58, 51, 48, 0.06);
        padding-bottom: 1rem;
    }

    .timeline-date {
      display: inline-block;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--accent);
      margin-bottom: 0.5rem;
      background: rgba(58, 51, 48, 0.06);
      padding: 0.3rem 0.8rem;
      border-radius: 999px;
    }

    .timeline-role {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--accent);
      margin: 0.75rem 0 0.25rem;
      line-height: 1.2;
      transition: color 0.3s ease;
    }
    
    .timeline-item:hover .timeline-role {
        color: #1a1614; /* Slightly darker/sharper on hover */
    }

    .timeline-company {
      font-size: 0.95rem;
      color: var(--text);
      display: block;
      font-weight: 400;
      opacity: 0.9;
    }

    .timeline-list {
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .timeline-list li {
      position: relative;
      padding-left: 1.25rem;
      margin-bottom: 0.6rem;
      font-size: 0.95rem;
      color: var(--text);
      line-height: 1.6;
    }
    
    .timeline-list li:last-child {
        margin-bottom: 0;
    }

    .timeline-list li::before {
      content: '→';
      position: absolute;
      left: 0;
      color: var(--accent);
      opacity: 0.5;
      font-size: 0.9em;
      top: 0.1em;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .timeline-item:hover .timeline-list li::before {
        transform: translateX(4px);
        opacity: 1;
    }

    .resume-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 1.5rem;
      padding: 0.6rem 1.2rem;
      background: transparent;
      border: 1px solid var(--accent);
      color: var(--accent);
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      transition: all 0.2s ease;
    }

    .resume-button:hover {
      background: var(--accent);
      color: var(--bg);
      box-shadow: 0 4px 12px rgba(58, 51, 48, 0.15);
    }

    .timeline-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1.25rem;
      padding-top: 1rem;
      border-top: 1px dashed rgba(58, 51, 48, 0.1);
    }

    .timeline-tag {
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--text);
      background: rgba(58, 51, 48, 0.05);
      padding: 0.25rem 0.6rem;
      border-radius: 6px;
      transition: background 0.2s ease, color 0.2s ease;
    }

    .timeline-item:hover .timeline-tag {
      background: rgba(58, 51, 48, 0.08);
      color: var(--accent);
    }
    
    footer {
      text-align: center;
      padding: 3rem 0 1.5rem;
      font-size: 0.85rem;
      color: var(--text);
      position: relative;
      z-index: 1;
    }
    
    @media (max-width: 700px) {
        .timeline {
            padding-left: 0;
        }
        .timeline::before {
            left: 1rem;
        }
        .timeline-item {
            padding-left: 3rem;
        }
        .timeline-marker {
            left: 0.35rem;
        }
        .timeline-content {
            padding: 1.5rem;
        }
    }
  </style>
</head>
<body>
  <canvas id="waveCanvas" aria-hidden="true"></canvas>
  <main class="page">
    <header id="top">
      <div class="hero">
        <h1>Nathan Johnson</h1>
        <p style="margin-bottom: 0;">Senior at Loyola University Chicago studying Computer Science & Incoming Software Engineer at Enova International</p>
        <p style="margin-top: 1; margin-bottom: 0;">Passionate about building scalable fintech infrastructure, high-performance computing, and AI-driven solutions.</p>
        <div class="hero-socials" aria-label="Connect with me">
          <a class="social-link" href="https://github.com/nathanjohnsongithub" target="_blank" rel="noreferrer noopener" aria-label="GitHub">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 .5C5.65.5.5 5.65.5 12c0 5.09 3.29 9.4 7.86 10.94.58.11.79-.25.79-.56 0-.28-.01-1.2-.02-2.18-3.2.7-3.88-1.4-3.88-1.4-.53-1.35-1.29-1.72-1.29-1.72-1.06-.73.08-.72.08-.72 1.18.08 1.8 1.22 1.8 1.22 1.04 1.78 2.74 1.27 3.41.97.1-.76.4-1.27.73-1.56-2.55-.29-5.24-1.28-5.24-5.72 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.9-.4 2.88-.4.98 0 1.96.14 2.88.4 2.2-1.5 3.17-1.19 3.17-1.19.64 1.59.24 2.76.12 3.05.74.82 1.19 1.86 1.19 3.13 0 4.45-2.69 5.42-5.26 5.71.41.36.78 1.07.78 2.16 0 1.56-.01 2.82-.01 3.2 0 .31.21.68.8.56C20.21 21.39 23.5 17.09 23.5 12 23.5 5.65 18.35.5 12 .5Z" />
            </svg>
          </a>
          <a class="social-link" href="https://www.linkedin.com/in/nathan-johnson-compsci/" target="_blank" rel="noreferrer noopener" aria-label="LinkedIn">
            <svg viewBox="0 0 24 24" aria-hidden="true" class="icon">
              <path d="M4.5 3.75a1.75 1.75 0 1 1 0 3.5 1.75 1.75 0 0 1 0-3.5Zm-1.5 5h3v11.5h-3V8.75Zm6 0h2.91v1.47h.04c.41-.78 1.43-1.6 2.95-1.6 3.16 0 3.75 2.08 3.75 4.78v6.85h-3v-6.1c0-1.45-.02-3.3-2.01-3.3-2.02 0-2.33 1.58-2.33 3.2v6.2h-3V8.75Z" />
            </svg>
          </a>
          <button class="social-link is-email" type="button" data-email="njohnson14@luc.edu" aria-label="Copy email">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M3 5h18a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2zm0 2v.35l9 5.65 9-5.65V7H3zm18 3.15-7.62 4.78a2 2 0 0 1-2.76 0L3 10.15V17a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-6.85z"/>
            </svg>
            <span class="copy-label" aria-hidden="true">Email copied to clipboard</span>
          </button>
        </div>
      </div>
    </header>

    <section id="projects" class="panel">
      <div class="section-heading">
        <span class="eyebrow">Selected work</span>
        <h2 style="color: var(--accent);">Some projects worth sharing</h2>
        <p>Explorations in flow fields, generative design, and user experience.</p>
      </div>
      <div class="project-grid">
        
        <article class="project-card">
          <button class="close-btn">← Back to projects</button>
          <div class="project-summary">
            <span class="project-meta">Machine Learning</span>
            <h3>Movie Recommendation Website</h3>
            <p>A Python-based collaborative filtering engine that scrapes Letterboxd ratings to generate personalized movie recommendations using SVD.</p>
            <a class="project-link" href="#">Learn more</a>
          </div>
          
          <div class="project-details">
             <h3>Movie Recommendation Website</h3>
             
             <h4>Overview</h4>
             <p>For the Fall 2024 semester Loyola's AI Club completed a Python-based movie recommendation system that scrapes user movie ratings from Letterboxd and generates personalized movie recommendations using collaborative filtering techniques. </p>
      
             <h4>My Role</h4>
             <p>As president of the club and leader of the Model group I was responsible for overseeing the development and implementation of the recommendation algorithms, coordinating data collection efforts, and ensuring the integration of the model with the web application as well as coordinating and collaboration between different teams for my role as president. </p>
   
             <h4>Tech Stack</h4>
             <ul style="list-style: none; padding: 0; margin-bottom: 2rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Python</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Flask</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">PostgreSQL</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">scikit-learn</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">TailwindCSS</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Heroku</li>
             </ul>

             <h4>Model</h4>
             <p>The recommendation pipeline takes a Letterboxd username, scrapes the user’s movie ratings, and combines them with a large global ratings dataset. A collaborative filtering model (SVD or Baseline using scikit-surprise) is trained on the merged data to predict ratings for movies the user hasn’t seen. Candidates are filtered using a configurable popularity/obscurity threshold, then ranked to return top-N recommendations.</p>
             <p>In addition, a content-based system uses TF-IDF and cosine similarity on movie metadata (genres, languages, countries) to surface similar films.</p>
             
             <h4>Application</h4>
             <p>A full-stack Flask web application with server-side rendering using Jinja2. The UI is styled with TailwindCSS and enhanced with vanilla JavaScript. PostgreSQL and SQLAlchemy manage users, movies, ratings, and watchlists, with Flask-Login handling authentication and sessions. Cloudinary is used for user profile image storage. The app is production-ready and deployed using Gunicorn in a Heroku-style environment.</p>

             <div style="margin: 2rem 0; display: flex; gap: 1rem;">
                <a href="https://movierec-f24-e040c420e2f6.herokuapp.com/" target="_blank" rel="noreferrer noopener" style="display: inline-flex; align-items: center; gap: 0.5rem; background: var(--accent); color: var(--bg); padding: 0.7rem 1.4rem; border-radius: 999px; font-size: 0.9rem; font-weight: 600; text-transform: uppercase;">
                    Live Site
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                </a>
                <a href="https://github.com/loyolaAI/MovieRec-F24" target="_blank" rel="noreferrer noopener" style="display: inline-flex; align-items: center; gap: 0.5rem; background: transparent; border: 1px solid var(--accent); color: var(--accent); padding: 0.7rem 1.4rem; border-radius: 999px; font-size: 0.9rem; font-weight: 600; text-transform: uppercase;">
                    GitHub
                    <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true" fill="currentColor" stroke="none"><path d="M12 .5C5.65.5.5 5.65.5 12c0 5.09 3.29 9.4 7.86 10.94.58.11.79-.25.79-.56 0-.28-.01-1.2-.02-2.18-3.2.7-3.88-1.4-3.88-1.4-.53-1.35-1.29-1.72-1.29-1.72-1.06-.73.08-.72.08-.72 1.18.08 1.8 1.22 1.8 1.22 1.04 1.78 2.74 1.27 3.41.97.1-.76.4-1.27.73-1.56-2.55-.29-5.24-1.28-5.24-5.72 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.9-.4 2.88-.4.98 0 1.96.14 2.88.4 2.2-1.5 3.17-1.19 3.17-1.19.64 1.59.24 2.76.12 3.05.74.82 1.19 1.86 1.19 3.13 0 4.45-2.69 5.42-5.26 5.71.41.36.78 1.07.78 2.16 0 1.56-.01 2.82-.01 3.2 0 .31.21.68.8.56C20.21 21.39 23.5 17.09 23.5 12 23.5 5.65 18.35.5 12 .5Z"/></svg>
                </a>
             </div>
             
             <div class="project-gallery">
                <img src="images/projects/movie-rec/MovieScreen.png" alt="Movie Recommendation Screen">
                <img src="images/projects/movie-rec/Recommended.png" alt="Recommended Movies View">
             </div>
          </div>
        </article>

        <article class="project-card">
          <button class="close-btn">← Back to projects</button>
          <div class="project-summary">
            <span class="project-meta">Product</span>
            <h3>Reddit Story Clipper</h3>
            <p>An automated pipeline that transforms engaging Reddit stories into vertical video clips with text-to-speech narration and Minecraft parkour background.</p>
            <a class="project-link" href="#">Learn more</a>
          </div>
          <div class="project-details">
             <h3>Reddit Story Clipper</h3>
             
             <h4>Overview</h4>
             <p>An automated content creation pipeline designed to transform text-based Reddit stories into high-engagement short-form video content. This Python tool bridges the gap between text communities and video platforms like TikTok and Instagram Reels by generating complete, narrated videos instantly.</p>
             
             <h4>Tech Stack</h4>
             <ul style="list-style: none; padding: 0; margin-bottom: 2rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Python</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">MoviePy</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">FFmpeg</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Google Cloud TTS</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">PRAW</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">NLTK</li>
             </ul>

             <h4>Engineering & Architecture</h4>
             <ul style="list-style-type: disc; padding-left: 1.2rem; margin-bottom: 1.5rem;">
                 <li><strong>Content Discovery:</strong> Connects to the Reddit API (via PRAW) to algorithmically identify trending stories based on upvote velocity, sentiment analysis, and subreddit relevance.</li>
                 <li><strong>Audio Processing:</strong> Converts raw text to high-fidelity speech using Google Cloud TTS. Leverages NLTK for natural sentence chunking and pacing to ensure life-like narration flow.</li>
                 <li><strong>Video Assembly:</strong> Programmatically configures MoviePy and FFmpeg to layer narrated audio, synchronized dynamic captions, and engaging background footage (e.g., Minecraft parkour) into a single rendered output.</li>
             </ul>

             <h4>Workflow</h4>
             <p>The system operates as a configurable CLI tool. Users define target subreddits, voice parameters, and video styles via a centralized YAML configuration file, allowing for batch production of content with consistent branding. The pipeline handles the entire rendering process, outputting polished vertical videos ready for upload.</p>
             
             <div class="project-gallery">
                <img src="images/projects/tiktok-auto/final_output_0.png" alt="Reddit Story Clipper Output" style="max-width: 400px; margin: 0 auto; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
             </div>
          </div>
        </article>

        <article class="project-card">
          <button class="close-btn">← Back to projects</button>
          <div class="project-summary">
            <span class="project-meta">Web Application</span>
            <h3>Virtual Couples Scrapbook</h3>
            <p>A personal digital scrapbook explicitly designed to protect and modernize cherished memories, bridging a static legacy photo album with a modern, cloud-based archive.</p>
            <a class="project-link" href="#">Learn more</a>
          </div>
          <div class="project-details">
             <h3>Virtual Couples Scrapbook</h3>
             
             <h4>Overview</h4>
             <p>I built this website as a digital scrapbook for my girlfriend, Hannah — a place to preserve our memories while giving new life to an old, hand-coded archive. What started as a static site evolved into a hybrid web app with a secure backend, allowing us to safely upload new photos, notes, and moments without losing the charm of the original site. It’s private, playful, and designed to grow with us.</p>
             
             <h4>Tech Stack</h4>
             <ul style="list-style: none; padding: 0; margin-bottom: 2rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">HTML5</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Tailwind CSS</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Vanilla JavaScript</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Node.js (Serverless)</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Supabase</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">PostgreSQL</li>
             </ul>

             <h4>Engineering & Features</h4>
             <ul style="list-style-type: disc; padding-left: 1.2rem; margin-bottom: 1.5rem;">
                 <li><strong>Private Memory Uploads:</strong> A custom password-protected admin area secures all upload routes using hashed credentials and signed session cookies, so adding new memories is simple and safe.</li>
                 <li><strong>Cloud Migration:</strong> Built an automated pipeline to move legacy images and metadata from local storage into Supabase Storage and a PostgreSQL database, making the scrapbook scalable and future-proof.</li>
                 <li><strong>Best of Old + New:</strong> The original static pages live alongside dynamically loaded content from the database, blending nostalgia with modern functionality.</li>
                 <li><strong>Interactive Surprises:</strong> Includes a gamified scavenger hunt that lets Hannah unlock hidden memories through puzzles — because a scrapbook should be fun, not just functional.</li>
             </ul>

            <div class="project-gallery" style="grid-template-columns: 1fr; gap: 2rem;">
              <img src="images/projects/scrapbook/password.png" alt="Virtual Couples Scrapbook Output" style="max-width: 600px; margin: 0 auto;">
              <img src="images/projects/scrapbook/scrapbook.png" alt="Virtual Couples Scrapbook Output" style="max-width: 600px; margin: 0 auto;">
            </div>
          </div>
        </article>

        <article class="project-card">
          <button class="close-btn">← Back to projects</button>
          <div class="project-summary">
            <span class="project-meta">Discord Bot</span>
            <h3>Discord Parlay Bot</h3>
            <p>A sophisticated Discord bot that generates optimized sports betting parlays with real-time odds, fair probability analysis, and expected value calculations.</p>
            <a class="project-link" href="#">Learn more</a>
          </div>
          
          <div class="project-details">
             <h3>Discord Parlay Bot</h3>
             
             <h4>Overview</h4>
             <p>The Discord Parlay Bot bridges the gap between casual sports fandom and analytical betting. Instead of manually scouring sportsbooks for combined bets, users can simply request a parlay directly within their Discord community. The bot doesn't just randomly pick winners; it constructs a three-leg bet based on live market data and performs a quantitative analysis on the wager. It decompiles the sportsbook's odds to determine the "fair" price, calculates the expected return on investment (ROI), and suggests an optimal bet size. Built with a focus on modularity and community management, it serves as an interactive tool for sports communities to discuss and discover value bets together.</p>

             <h4>Tech Stack</h4>
             <ul style="list-style: none; padding: 0; margin-bottom: 2rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Python 3.11+</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">discord.py</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">httpx</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">The Odds API</li>
                <li style="background: rgba(58, 51, 48, 0.05); padding: 0.3rem 0.8rem; border-radius: 6px; font-size: 0.85rem;">Docker</li>
             </ul>

             <h4>Engineering & Features</h4>
             <ul style="list-style-type: disc; padding-left: 1.2rem; margin-bottom: 1.5rem;">
                 <li><strong>On-Demand Parlay Generation:</strong> Users can generate multi-leg parlays instantly via slash commands (/parlay), customizing for sport (NBA, NFL, MLB, NHL), market, and risk tolerance.</li>
                 <li><strong>Live Odds Integration:</strong> Fetches real-time data from major sportsbooks (FanDuel, DraftKings, etc.) via The Odds API.</li>
                 <li><strong>Advanced Analytics:</strong> Calculates "Fair Probability," Expected Value (EV+), and provides Kelly Criterion staking recommendations for every generated bet.</li>
                 <li><strong>Risk Management:</strong> Includes correlation warnings to prevent conflicting parlay legs and configurable daily usage limits based on user roles.</li>
                 <li><strong>Admin Controls:</strong> Built-in health checks and role-based access limits to manage API usage costs efficiently.</li>
             </ul>

            <div class="project-gallery" style="grid-template-columns: 1fr; gap: 2rem;">
              <img src="images/projects/parlay-bot/commands.png" alt="Discord Parlay Bot Commands" style="max-width: 600px; margin: 0 auto;">
              <img src="images/projects/parlay-bot/parlay.png" alt="Discord Parlay Bot Output" style="max-width: 600px; margin: 0 auto;">
            </div>
          </div>
        </article>

      </div>
    </section>

    <section id="timeline" class="panel">
      <div class="section-heading">
        <span class="eyebrow">Experience</span>
        <h2 style="color: var(--accent);">Curriculum Vitae</h2>
        <p>Engineering, research, and leadership work across fintech, Computational Sciences, and campus communities.</p>
        <a href="Nathan_Johnson_Resume.pdf" target="_blank" class="resume-button">
          View My Resume
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M7 17l9.2-9.2M17 17V7H7"/>
          </svg>
        </a>
      </div>
      <div class="timeline">
        
        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">Jun 2025 – Aug 2025</span>
              <h3 class="timeline-role">Software Engineering Intern</h3>
              <span class="timeline-company">Enova International · Chicago, IL</span>
            </div>
            <ul class="timeline-list">
              <li>Completed an internship in the Small & Medium Business division modernizing legacy systems via cloud-native architecture.</li>
              <li>Migrated core business functionality into Go + AWS Lambda microservices backed by Salesforce Apex and Terraform.</li>
              <li>Partnered with cross-functional teams to deliver fault-tolerant, production-ready solutions that scale with the platform.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">Go</span>
              <span class="timeline-tag">AWS Lambda</span>
              <span class="timeline-tag">Salesforce Apex</span>
              <span class="timeline-tag">Terraform</span>
              <span class="timeline-tag">Microservices</span>
            </div>
          </div>
        </article>

        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">Jan 2025 – Apr 2025</span>
              <h3 class="timeline-role">Business Development Intern</h3>
              <span class="timeline-company">TrueLayer · London, UK</span>
            </div>
            <ul class="timeline-list">
              <li>Support a leading Pay-by-Bank/Open Banking provider by identifying commercial opportunities in fast-moving markets.</li>
              <li>Analyze partner data to surface strategic plays that grow A2A adoption.</li>
              <li>Collaborate across technical and non-technical teams, reinforcing communication and problem-solving skills.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">Pay-by-Bank</span>
              <span class="timeline-tag">Open Banking</span>
              <span class="timeline-tag">Data Analysis</span>
              <span class="timeline-tag">Business Development</span>
            </div>
          </div>
        </article>

        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">May 2024 – Aug 2024</span>
              <h3 class="timeline-role">Computational Research Aide — Sophomore</h3>
              <span class="timeline-company">Argonne National Laboratory · Lemont, IL</span>
            </div>
            <ul class="timeline-list">
              <li>Offloaded performance-critical sections of HPC programs to GPUs using SYCL.</li>
              <li>Optimized parallel workloads using OpenMP, improving scalability and efficiency across large clusters.</li>
              <li>Conducted profiling (MAQAO) to identify bottlenecks and implemented multi-threaded optimizations.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">SYCL</span>
              <span class="timeline-tag">OpenMP</span>
              <span class="timeline-tag">GPU</span>
              <span class="timeline-tag">HPC</span>
              <span class="timeline-tag">C++</span>
              <span class="timeline-tag">Performance Profiling</span>
            </div>
          </div>
        </article>

        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">Jan 2024 – Present</span>
              <h3 class="timeline-role">Computer Science Tutor</h3>
              <span class="timeline-company">Loyola University Chicago · Chicago, IL</span>
            </div>
            <ul class="timeline-list">
              <li>Weekly tutor in the Computer Science Department, supporting students in Computer Science core courses.</li>
              <li>Subjects include Introduction to Computing Tools and Techniques, Discrete Structures, Object-Oriented Programming, Computer Systems, and Data Structures.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">Data Structures</span>
              <span class="timeline-tag">OOP</span>
              <span class="timeline-tag">Algorithms</span>
              <span class="timeline-tag">Teaching</span>
              <span class="timeline-tag">Tutoring</span>

            </div>
          </div>
        </article>

        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">Aug 2023 – Dec 2024</span>
              <h3 class="timeline-role">Loyola AI Club President</h3>
              <span class="timeline-company">Loyola University Chicago · Chicago, IL</span>
            </div>
            <ul class="timeline-list">
              <li>Led a machine-learning movie recommendation project utilizing Pandas, NumPy, and Scikit-learn with around 15 active contributors.</li>
              <li>Organized weekly meetings, competitions, and guest speakers to expand member engagement tripling the active membership.</li>
              <li>Increased club presence on campus while strengthening leadership and communication skills.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">Artificial Intelligence</span>
              <span class="timeline-tag">Machine Learning</span>
              <span class="timeline-tag">Club</span>
              <span class="timeline-tag">Leadership</span>
            </div>
          </div>
        </article>

        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">May 2023 – Aug 2023</span>
              <h3 class="timeline-role">Computational Research Aide</h3>
              <span class="timeline-company">Argonne National Laboratory · Lemont, IL</span>
            </div>
            <ul class="timeline-list">
              <li>Developed Python-based HPC workflows and integrated C/C++ libraries for performance-critical modules.</li>
              <li>Employed cProfile and mpi4py for benchmarking and parallel execution, boosting distributed performance.</li>
              <li>Researched various Python and C/C++ bindings for interoperability and performance optimization.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">Python</span>
              <span class="timeline-tag">HPC</span>
              <span class="timeline-tag">Research Lab</span>
              <span class="timeline-tag">C/C++</span>
              <span class="timeline-tag">Performance Optimization</span>
            </div>
          </div>
        </article>

        <article class="timeline-item">
          <div class="timeline-marker" aria-hidden="true"></div>
          <div class="timeline-content">
            <div class="timeline-header">
              <span class="timeline-date">Aug 2022 – Expected May 2026</span>
              <h3 class="timeline-role">B.S. in Computer Science</h3>
              <span class="timeline-company">Loyola University Chicago · Chicago, IL</span>
            </div>
            <ul class="timeline-list">
              <li><strong>GPA:</strong> 3.93</li>
              <li><strong>Relevant Coursework:</strong> Data Structures and Algorithms, Discrete Math, Calculus I & II, Linear Algebra, Computer Systems, Programming Languages, Operating Systems, Object-Oriented Design, Machine Learning, Software Engineering.</li>
              <li><strong>Future Coursework:</strong> Database Programming, NLP, Deep Learning.</li>
            </ul>
            <div class="timeline-tags">
              <span class="timeline-tag">Computer Science</span>
              <span class="timeline-tag">Education</span>
              <span class="timeline-tag">University</span>
              <span class="timeline-tag">DS & Algorithms</span>
            </div>
          </div>
        </article>
      </div>
    </section>
  </main>

  <footer>
    <p>© <span id="year"></span> Nathan Johnson.</p>
  </footer>

  <script>
    // --- Footer Year ---
    const year = new Date().getFullYear();
    document.getElementById('year').textContent = year;

    // --- Project Expansion Logic with staged fades ---
    const projectSection = document.getElementById('projects');
    const projectGrid = projectSection.querySelector('.project-grid');
    let isAnimating = false;
    let initialCardRect = null; // Store initial position for closing animation

    const toNumber = (value) => Number.parseFloat(value) || 0;
    const getPanelExtras = () => {
      const styles = window.getComputedStyle(projectSection);
      return (
        toNumber(styles.borderTopWidth) +
        toNumber(styles.borderBottomWidth)
      );
    };

    async function expandProject(card) {
      if (isAnimating) return;
      isAnimating = true;

      // 1. Fade out summary and siblings
      card.classList.add('fading-out');
      projectGrid.classList.add('has-expanded-card'); // Hides siblings via CSS
      projectSection.classList.add('has-expanded-card'); // Hides heading

      // Wait for fade out (300ms matches CSS transition)
      await new Promise(r => setTimeout(r, 300));
      
      // 2. Measure BEFORE hiding summary (so we get full size)
      const cardRect = card.getBoundingClientRect();
      const gridRect = projectGrid.getBoundingClientRect(); // Use grid as reference
      
      // Store for closing
      initialCardRect = {
        top: cardRect.top - gridRect.top,
        left: cardRect.left - gridRect.left,
        width: cardRect.width,
        height: cardRect.height
      };

      // Lock panel height to prevent collapse when card becomes absolute
      const panelRect = projectSection.getBoundingClientRect();
      const startPanelHeight = panelRect.height;
      projectSection.style.height = `${startPanelHeight}px`;

      // Calculate initial position relative to grid
      const relativeTop = initialCardRect.top;
      const relativeLeft = initialCardRect.left;

      // Apply fixed positioning state to card to match current visual state
      // We use inline styles to animate
      card.style.position = 'absolute';
      card.style.top = `${relativeTop}px`;
      card.style.left = `${relativeLeft}px`;
      card.style.width = `${cardRect.width}px`;
      card.style.height = `${cardRect.height}px`;
      card.style.margin = '0';
      
      // NOW hide summary so it doesn't interfere with content layout internally
      // but the card size is already locked by inline styles
      card.classList.add('summary-hidden');
      
      card.classList.add('expanded'); // Changes background, removes shadow, etc.

      // Force reflow
      void card.offsetWidth;

      // 3. Animate to full size
      // Target: Fill the entire panel (inside borders)
      // We need to calculate the position relative to the grid (which is the offset parent)
      // The target is the top-left of the panel content area.
      // Since grid is inside panel, we need the offset of grid relative to panel content box.
      
      const panelStyle = window.getComputedStyle(projectSection);
      const panelPaddingTop = parseFloat(panelStyle.paddingTop);
      const panelPaddingLeft = parseFloat(panelStyle.paddingLeft);
      const panelBorderTop = parseFloat(panelStyle.borderTopWidth);
      const panelBorderLeft = parseFloat(panelStyle.borderLeftWidth);
      
      // The grid's top relative to the viewport
      const gridTop = gridRect.top;
      // The panel's content box top relative to viewport
      const panelContentTop = panelRect.top + panelBorderTop + panelPaddingTop;
      
      // The offset we need to move the card UP to hit the top of the panel content area
      // relative to the grid's top.
      // If grid is below panel top (due to heading), this will be negative.
      const targetTop = panelContentTop - gridTop - panelPaddingTop; // Wait, we want to cover padding too?
      // The user said "fill the entire project section box".
      // Usually this means covering the padding too.
      // So we want to go to (panelRect.top + panelBorderTop) - gridRect.top
      
      const targetTopOffset = (panelRect.top + panelBorderTop) - gridRect.top;
      const targetLeftOffset = (panelRect.left + panelBorderLeft) - gridRect.left;
      
      // Target width/height is the full content box of the panel (width - borders)
      const targetWidth = panelRect.width - parseFloat(panelStyle.borderLeftWidth) - parseFloat(panelStyle.borderRightWidth);
      // Initial target height is panel height - borders
      const targetHeight = panelRect.height - parseFloat(panelStyle.borderTopWidth) - parseFloat(panelStyle.borderBottomWidth);

      card.style.top = `${targetTopOffset}px`;
      card.style.left = `${targetLeftOffset}px`;
      card.style.width = `${targetWidth}px`;
      card.style.height = `${targetHeight}px`;
      
      // Wait for expansion (600ms matches CSS transition)
      await new Promise(r => setTimeout(r, 600));
      
      // 4. Fade in new content & Adjust height for content
      card.classList.add('details-visible');
      
      // We no longer adjust height for content. The card stays at targetHeight.
      // Overflow is handled by CSS (overflow-y: auto)
      
      isAnimating = false;
    }

    async function closeProject() {
      const expandedCard = projectSection.querySelector('.project-card.expanded');
      if (!expandedCard || isAnimating) return;
      isAnimating = true;

      // 1. Fade out details
      expandedCard.classList.remove('details-visible');
      
      // Wait for fade out (400ms)
      await new Promise(r => setTimeout(r, 400));

      // 2. Animate back to original position
      // Restore fixed height for animation
      const currentRect = expandedCard.getBoundingClientRect();
      expandedCard.style.height = `${currentRect.height}px`;
      
      // Force reflow
      void expandedCard.offsetWidth;

      if (initialCardRect) {
          expandedCard.style.top = `${initialCardRect.top}px`;
          expandedCard.style.left = `${initialCardRect.left}px`;
          expandedCard.style.width = `${initialCardRect.width}px`;
          expandedCard.style.height = `${initialCardRect.height}px`;
      }

      // Animate panel height back to original if it grew
      // We don't have the exact original height stored easily, but we can let it be auto?
      // No, we need to animate it.
      // Let's just remove the explicit height on projectSection after animation?
      // Or animate it to a guessed height?
      // Better: Measure the grid height?
      // Since the grid items are hidden, the grid height might be collapsed?
      // No, they are opacity: 0, but still take space?
      // Wait, I set `pointer-events: none; opacity: 0`. They still take space in flow.
      // So the grid height should be correct.
      // Let's measure the natural height of the section.
      
      // Temporarily remove height constraint to measure? No that would jump.
      // Let's just animate the card. The panel height will snap back when we remove explicit height.
      // Or we can try to animate panel height too.
      
      // Wait for shrink (600ms)
      await new Promise(r => setTimeout(r, 600));

      // 3. Cleanup and Fade In Summary
      expandedCard.classList.remove('expanded');
      expandedCard.classList.remove('summary-hidden');
      expandedCard.style = ''; // Clear inline styles
      
      projectSection.style.height = ''; // Clear panel height
      projectSection.classList.remove('has-expanded-card');
      projectGrid.classList.remove('has-expanded-card');
      
      // Force reflow to ensure summary is ready to fade in
      void expandedCard.offsetWidth;
      
      expandedCard.classList.remove('fading-out');
      
      isAnimating = false;
    }

    document.querySelectorAll('.project-link').forEach((link) => {
      link.addEventListener('click', (event) => {
        event.preventDefault();
        const card = link.closest('.project-card');
        expandProject(card);
      });
    });

    document.querySelectorAll('.close-btn').forEach((button) => {
      button.addEventListener('click', (event) => {
        event.preventDefault();
        closeProject();
      });
    });

    const emailButton = document.querySelector('.social-link.is-email');
    const copyLabel = emailButton?.querySelector('.copy-label');
    let copyFeedbackTimeout;

    const showCopyFeedback = (message) => {
      if (!emailButton || !copyLabel) return;
      copyLabel.textContent = message;
      emailButton.classList.add('show-feedback');
      clearTimeout(copyFeedbackTimeout);
      copyFeedbackTimeout = setTimeout(() => {
        emailButton.classList.remove('show-feedback');
      }, 2000);
    };

    async function copyEmailToClipboard() {
      if (!emailButton) return;
      const email = emailButton.dataset.email;
      try {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(email);
        } else {
          const tempInput = document.createElement('textarea');
          tempInput.value = email;
          tempInput.setAttribute('readonly', '');
          tempInput.style.position = 'absolute';
          tempInput.style.left = '-9999px';
          document.body.appendChild(tempInput);
          tempInput.select();
          document.execCommand('copy');
          document.body.removeChild(tempInput);
        }
        showCopyFeedback('Email copied to clipboard');
      } catch (error) {
        showCopyFeedback('Copy not supported');
      }
    }

    emailButton?.addEventListener('click', copyEmailToClipboard);

    window.addEventListener('resize', () => {
        // Reset if resized while expanded to avoid layout issues
        if (projectSection.classList.contains('has-expanded-card')) {
             // Ideally we'd recalculate, but for now let's just keep it safe
             const expandedCard = projectSection.querySelector('.project-card.expanded');
             if(expandedCard) {
                 projectSection.style.height = 'auto';
                 const newHeight = projectSection.getBoundingClientRect().height;
                 projectSection.style.height = `${newHeight}px`;
             }
        }
    });

    // --- FLOW FIELD ANIMATION (Unchanged) ---
    const canvas = document.getElementById('waveCanvas');
    const ctx = canvas.getContext('2d');
    const mouse = { x: -1000, y: -1000 };

    let particleCount = 4000; 
    const particleSize = 1.3;
    const flowScale = 0.003;
    const speed = 1.8; 
    const fadeRate = 0.08; 

    const colors = [
      'rgba(58, 51, 48, 0.35)',    // Dark Espresso - softer
      'rgba(124, 110, 99, 0.30)',  // Muted Cocoa - softer
      'rgba(216, 207, 198, 0.40)', // Soft Taupe - softer
      'rgba(180, 170, 158, 0.35)'  // Warm Gray - softer
    ];

    const bgColor = 'rgb(246, 240, 231)'; // Cream 

    let width = window.innerWidth;
    let height = window.innerHeight;
    let particles = [];
    let time = 0;
    let animationFrameId;

    const noise = (x, y, z) => {
      const p = 50 * Math.sin(x * 0.01 + z) + 50 * Math.cos(y * 0.01 + z);
      return Math.sin(x * 0.005 + p * 0.01 + z) + Math.cos(y * 0.005 + p * 0.01 + z);
    };

    function resizeCanvas() {
      const dpr = window.devicePixelRatio || 1;
      width = window.innerWidth;
      height = window.innerHeight;

      // Adjust particle count based on screen size (approx. 1 particle per 500px^2)
      particleCount = Math.floor((width * height) / 750);

      canvas.width = width * dpr;
      canvas.height = height * dpr;
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.scale(dpr, dpr);
      
      initParticles();
      
      ctx.fillStyle = bgColor;
      ctx.fillRect(0, 0, width, height);
    }

    function handleMouseMove(event) {
      mouse.x = event.clientX;
      mouse.y = event.clientY;
    }

    function handleMouseLeave() {
      mouse.x = -1000;
      mouse.y = -1000;
    }

    class Particle {
      constructor() {
        this.reset(true);
      }

      reset(randomizeAge = false) {
        this.x = Math.random() * width;
        this.y = Math.random() * height;
        this.color = colors[Math.floor(Math.random() * colors.length)];
        this.age = randomizeAge ? Math.random() * 100 : 0;
        this.lifespan = 150 + Math.random() * 150;
        this.speedModifier = 0.8 + Math.random() * 0.4;
      }

      update() {
        const angle = noise(this.x * flowScale, this.y * flowScale, time * 0.0005) * Math.PI * 2;

        const dx = this.x - mouse.x;
        const dy = this.y - mouse.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        
        let interactionX = 0;
        let interactionY = 0;
        
        const radius = 120; 
        const maxForce = 3; 

        if (dist < radius) {
            const force = (radius - dist) / radius;
            const pushAngle = Math.atan2(dy, dx);
            
            interactionX = Math.cos(pushAngle) * force * maxForce;
            interactionY = Math.sin(pushAngle) * force * maxForce;
        }

        this.x += Math.cos(angle) * speed * this.speedModifier + interactionX;
        this.y += Math.sin(angle) * speed * this.speedModifier + interactionY;
        this.age += 1;

        if (this.x < 0 || this.x > width || this.y < 0 || this.y > height || this.age > this.lifespan) {
          this.reset();
        }
      }

      draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, particleSize, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function initParticles() {
      particles = [];
      for (let i = 0; i < particleCount; i += 1) {
        particles.push(new Particle());
      }
    }

    function animateFlowField() {
      ctx.fillStyle = `rgba(246, 240, 231, ${fadeRate})`;
      ctx.fillRect(0, 0, width, height);

      particles.forEach((particle) => {
        particle.update();
        particle.draw();
      });

      time += 1;
      animationFrameId = requestAnimationFrame(animateFlowField);
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    window.addEventListener('mousemove', handleMouseMove);
    window.addEventListener('mouseleave', handleMouseLeave);
    animateFlowField();

    function cleanup() {
      cancelAnimationFrame(animationFrameId);
      window.removeEventListener('resize', resizeCanvas);
      window.removeEventListener('mousemove', handleMouseMove);
      window.removeEventListener('mouseleave', handleMouseLeave);
      window.removeEventListener('pagehide', cleanup);
      window.removeEventListener('beforeunload', cleanup);
    }

    window.addEventListener('pagehide', cleanup);
    window.addEventListener('beforeunload', cleanup);
  </script>
</body>
</html>
